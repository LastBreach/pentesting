<html>
<head></head>
<body>
<h1>File inclusion vulnerability - #0</h1>

<?php
// example script for an old file inclusion vulnerability for PHP < 5.3.4
// Paths with NULL in them (foo\0bar.txt) are now considered as invalid (CVE-2006-7243).

// Example of post 5.3.3 PHP
// -> GET /include0.php?file=/etc/passwd%00 HTTP/1.1
// -> PHP Warning:  include(): Failed opening '/etc/passwd' for inclusion 
// Including /etc/passwd failed even thought the file exists.

// run: put file in any php-enabled web directory or run 'php -S localhost:8000' in the directory with the file

// web based exploitation
$file = $_GET['file'];

// set rootdir if you want to (pseudo) limit inclusion to files in a certain directory
$rootdir="";

if (file_exists($rootdir.$file.'.php')) {
    include $rootdir.$file.'.php';
} else
    echo "file does not exist!";
}

<?
