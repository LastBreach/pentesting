<html>
	<head></head>
	<body>
		<h1>LFI/RFI Test Seite</h1>
		<br>
		<a href="index.php?page=hallo.php&func=unsafe">Unsafe Include</a> - 
		<a href="index.php?page=hallo&func=safe">Safe Include</a><br><br>
	</body>
</html>

<?php

	function unsafe(){
		$page = $_GET['page'];
		
		if (file_exists("../include/".$page)) 
		{
			include("../include/".$page);
		} else {
			echo "Keine gültige Datei angegeben!";
		}
	}

	function safe(){
		$incl_dir = "../include/";
		$pagename = $_GET['page'];
		$fullpath = $incl_dir.$pagename.".php";
		
		if (ctype_alnum($pagename) and file_exists($fullpath)) 
		{
			include($fullpath);
		} else {
			echo "Keine gültige Datei angegeben!";
		}
	}
	
	if ($_GET['func']=="unsafe"){
		unsafe();
	} else if ($_GET['func']=="safe"){
		safe();
	}
?>
